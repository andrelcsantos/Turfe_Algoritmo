<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="desafio.css" />
  </head>

  <body>
    <div class="registros">
      <div class="cadastrar-integrantes">
        <h1>Adicione os integrantes da corrida</h1>
        <select name="" id="select_mob">
          <option value="cavalo">Cavalo</option>
          <option value="porco">Porco</option>
          <option value="axalote">Axalote</option>
          <option value="hoglin">Hoglin</option>
          <option value="ovelha">Ovelha</option>
        </select>
        <div>
          <p>Nome do integrante:</p>
          <input type="text" id="input_nome" />
        </div>
        <button onclick="cadastrar()">Cadastrar integrante</button>
      </div>

      <div class="participante">
        <h1>Participantes da corrida</h1>
        <div id="div_participantes"></div>
      </div>
    </div>
    <div>
      <p>Quantidade de voltas:</p>
      <input type="text" id="input_qunatidadeVoltas" />
      <button onclick="largada()">Iniciar partida</button>
    </div>
    <div id="div_mensagem"></div>
    <div id="div_podio"></div>
  </body>
</html>

<script>
  var quantidadeCavalos = 0;
  
  var listaParticipante = [];
  var listaCorrida = [];
  var listaTempoTotal = [];


  function cadastrar() {
    var mob = select_mob.value;
    var nome = input_nome.value.toLowerCase().trim();
    contadorNome = 0;


    if(listaParticipante.includes(nome) || listaParticipante.length == 6) {
      if(listaParticipante.includes(nome)) {
        alert("Ja existe um participante com o mesmo nome!");
      } else {
        alert("Só pode ter no máximo 6 participantes")
      }
    } else {
      div_participantes.innerHTML += `<img style="height: 150px" src="images/${mob}.png" alt=""><br>${nome}<br>`;
      listaParticipante.push(nome);
      quantidadeCavalos++;
    }
    // for (var i = 0; i < listaParticipante.length; i++) {
    //   if (listaParticipante[i][1] == nome) {
    //     contadorNome++;
    //   }
    // }
    // if (contadorNome == 0) {
    //   div_participantes.innerHTML += `<img style="height: 150px" src="images/${mob}.png" alt=""><br>${nome}<br>`;
    //   quantidadeCavalos++;
    // } 
  }


  function largada() {
    var quantidadeVoltas = Number(input_qunatidadeVoltas.value);

    if (quantidadeCavalos >= 2 && quantidadeVoltas > 0) {  

      listaCorrida = [];
      listaTempoTotal = [];

        for (var i = 0; i < quantidadeCavalos; i++) {
          listaTempoTotal[i] = 0;
        }

          for (var i = 0; i < quantidadeVoltas; i++) {
            var listaVolta = [];

            for(var j = 0; j < quantidadeCavalos; j++){
              var tempoAleatorio = Number((Math.random() * 2 + 7).toFixed(1));

              listaVolta[j] = tempoAleatorio;
              listaTempoTotal[j] += tempoAleatorio;
            }

          listaCorrida.push(listaVolta);

        }

        exibirMensagem();

      } else {
        if(quantidadeCavalos < 2){
          div_mensagem.innerHTML = "Precisa de 2 ou mais participantes"
        } else {
        div_mensagem.innerHTML = "A quantidade de voltas precisa ser maior que 0";
      }
    }


  function exibirMensagem() {
    var mensagem = "";

    for (var i = 0; i < listaCorrida.length; i++) {
      mensagem += `<br><br> Volta: ${i + 1} <br> `;

      for (var j = 0; j < quantidadeCavalos; j++) {
        var tempoVolta = listaCorrida[i][j];
        var soma = 0;

        for (var k = 0; k <= i; k++) {
          soma += listaCorrida[k][j];
        }

        mensagem += `${listaParticipante[j]} – ${tempoVolta} – Total: ${soma.toFixed(1)}<br>`;
      }
    }
    div_mensagem.innerHTML = mensagem;

    decidirPodio();
  }


  function decidirPodio() {
      var primeiroColocado = 0;
      var segundoColocado = 0;
      var terceiroColocado = 0;


    for (var i = 1; i < listaTempoTotal.length; i++) {
      if (listaTempoTotal[i] < listaTempoTotal[primeiro]) {
      primeiro = i;
    }
    }
    primeiroColocado = listaTempoTotal.indexOf(primeiroColocado);

    segundoColocado = 10000000;

    for (var i = 0; i < listaTempoTotal.length; i++) {
      if (
        segundoColocado > listaTempoTotal[i] &&
        listaTempoTotal[i] >= listaTempoTotal[primeiroColocado] &&
        i != primeiroColocado
      ) {
        segundoColocado = listaTempoTotal[i];
      }
    }

    segundoColocado = listaTempoTotal.indexOf(segundoColocado);

    terceiroColocado = 10000000;

    for (var i = 0; i < listaTempoTotal.length; i++) {
      if (
        terceiroColocado > listaTempoTotal[i] &&
        listaTempoTotal[i] >= listaTempoTotal[segundoColocado] &&
        listaTempoTotal[i] >= listaTempoTotal[primeiroColocado] &&
        i != primeiroColocado && i != segundoColocado
      ) {
        terceiroColocado = listaTempoTotal[i];
      }
    }

    terceiroColocado = listaTempoTotal.indexOf(terceiroColocado);

    console.log(
      `primeiro lugar foi o ${listaParticipante[primeiroColocado][0]} ${listaParticipante[primeiroColocado][1]}`
    );
    console.log(
      `segundo lugar foi o ${listaParticipante[segundoColocado][0]} ${listaParticipante[segundoColocado][1]}`
    );
    console.log(
      `terceiro lugar foi o ${listaParticipante[terceiroColocado][0]} ${listaParticipante[terceiroColocado][1]}`
    );
    div_podio.innerHTML = `Primeiro lugar foi o ${listaParticipante[primeiroColocado][0]} ${listaParticipante[primeiroColocado][1]}<br><img style="height: 150px" src="images/${listaParticipante[primeiroColocado][0]}.png" alt=""><br>Segundo lugar foi o ${listaParticipante[segundoColocado][0]} ${listaParticipante[segundoColocado][1]}<br><img style="height: 150px" src="images/${listaParticipante[segundoColocado][0]}.png" alt=""><br>Terceiro lugar foi o ${listaParticipante[terceiroColocado][0]} ${listaParticipante[terceiroColocado][1]}<br><img style="height: 150px" src="images/${listaParticipante[terceiroColocado][0]}.png" alt=""><br>`;
  }
  }
</script>
